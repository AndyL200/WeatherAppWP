<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="icon" href="pageFavIcon.png">
    <link rel="stylesheet" href="style1.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playwrite+AU+SA:wght@100..400&display=swap');
        </style>
</head>

<body>
    <header>
        <h6>Photo by <a href="/photographer/wax115-31362">wax115</a> on <a href="/">Freeimages.com</a></h6>
    <figure id = "bgm">
    <img id = "playIcon" onclick = "playMusic()" width = "50" height = "50" src = "play.svg">

    <figcaption>BGM by Andrew LeClair</figcaption>
</figure>

    <nav id = 'pageSelect'>
        <ul id = 'pageSelectList'>
            <li id = 'pageSelectItem'>
                <a href="/">Home</a>
            </li>
            <li id = 'pageSelectItem'>
                <a href="about.html">About</a>
            </li>
        </ul>
    </nav>
</header>
    <script>

        async function mainButnFunc() {
            var city = ""
            var IP = "";
            const response1 = await fetch("https://api.ipify.org/");
            const ip = await response1.text();
            IP = ip;
                const locationResponse = await fetch(`http://api.weatherapi.com/v1/ip.json?key=1863c61a79764cea9d2135128240807&q=${IP}`);
                const locationData = await locationResponse.json();
                city = locationData.city;
                    const weatherResponse = await fetch(`http://api.weatherapi.com/v1/current.json?key=1863c61a79764cea9d2135128240807&q=${city}`);
                        const response2 = await weatherResponse.json();
                        document.getElementById('Country').innerText = response2.location.country;
                        document.getElementById('City').innerText = city;
                        document.getElementById('genWeather').innerText = response2.current.condition.text;
                        document.getElementById('weatherImg').setAttribute('src', response2.current.condition.icon);
                        document.getElementById('Time').innerText = response2.location.localtime;
                        document.getElementById('Temperature').innerText = response2.current.temp_f;
                        document.getElementById('wind').innerText = response2.current.wind_mph;         
                        document.getElementById('pressure').innerText = response2.current.pressure_mb;         
                        document.getElementById('heat').innerText = response2.current.heatindex_f;         
                
        }
        var music = new Audio('First_Score.mp3');
        music.loop = true;
        music.volume = 0.5;
       
        // async function changeOpacity() {
        //     await new Promise(resolve => setTimeout(resolve, 1000));

        //     for(i = 0; i < 10; i++) {
        //         await document.getElementById('playIcon').changeOpacity(i/10);
        //     }
        // }
        //may come back to this


        async function playMusic() {
            
            if(music.currentTime == music.duration) {
                music.currentTime = 0;
                await music.play();
            }

            else if(document.getElementById('playIcon').getAttribute('src') == 'play.svg') {

            await music.play();
            await document.getElementById('playIcon').setAttribute('src', "pause.svg");
            // await changeOpacity();
            
            }
            else  {
                
            await music.pause();
            await document.getElementById('playIcon').setAttribute('src','play.svg');
            
            // music.currentTime=0;
            }
            
        }
    </script>
    <h1>
        Up for a coffee run?
    </h1>
    <button id="WeatherFindButton" onclick="mainButnFunc()">Let's see</button>
    <div id="weatherResponse">
        
    </div>
    <div class="articleList">

        <article class="infoView">
            <table>
                <tbody>
                    <tr>
                        <td>Your Country</td>
                        <td>Your City</td>
                    </tr>
                    <tr>
                        <td id = "Country" ></td>
                        <td id = "City"></td>
                    </tr>
                </tbody>
            </table>
        </article>

        <article class="infoView">
            <table>
                <tbody>
                    <tr>
                        <td>General Weather</td>
                    </tr>
                    <tr>
                        <td id = "genWeather"></td>
                    </tr>
                </tbody>
            </table>
        </article>

        <article class="infoView">
            <table>
                <tbody>
                    <tr>
                        <td>Current Time</td>
                </tr>
                    <tr >
                        <td id = "Time"></td>
                    </tr>
                </tbody>
            </table>
        </article>

        <article class="infoView">
            <table>
                <tbody>
                    <tr>
                        <td>Temp</td>
                    </tr>
                    <tr >
                        <td id = "Temperature"></td>

                    </tr>
                </tbody>
            </table>
        </article>
        
    </div>

    <div name = "Additional Info" class = "nerdWatch">
        <img id = "weatherImg">
    <div class = "windIndex">
        <h2>Wind</h2>
        <span id = "wind"></span>
    </div>

    <div class = "pressureWatch">
        <h2>Pressure</h2>
        <span id = "pressure"></span>
    </div>

    <div class = "heatIndex">
        <h2>Heat Index</h2>
        <span id="heat"></span>
    </div>
</div>
</body>

</html>